# 连连看塔防游戏项目需求文档

## 项目概述

连连看塔防游戏是一款创新的混合玩法游戏，结合了经典连连看消除玩法和塔防战略元素。

### 游戏核心玩法
1. 玩家在上半区进行连连看消除，获得资源
2. 资源掉落到下方地面，由矮人NPC收集
3. 使用资源在商店购买建筑物，在地面建造防御
4. 怪物从右侧刷新，向左侧城堡移动
5. 建筑物攻击怪物，保护城堡

### 胜负条件
- **胜利条件**：关卡时间结束时城堡仍然存在
- **失败条件**：怪物攻破城堡

## 整体架构

### 界面布局
- **上半区**：连连看区域（7x9网格）
- **下半区**：
  - 左侧：商店UI面板（常驻显示）
  - 中间：横版地面场景（单层）
  - 右侧：怪物刷新区域
- **最左边**：城堡（生命值标志）

### 层级关系
- 矮人NPC：最前层
- 建筑物：中间层
- 地面：背景层

## 模块划分

1. [连连看模块](./docs/连连看模块需求.md) ✅
2. [塔防模块](./docs/塔防模块需求.md) ✅
3. [资源经济系统](./docs/资源经济系统需求.md) ✅
4. [矮人NPC系统](./docs/矮人NPC系统需求.md) ✅
5. [怪物和战斗系统](./docs/怪物和战斗系统需求.md) ✅
6. [商店和建筑系统](./docs/商店和建筑系统需求.md) ✅
7. [关卡和胜负条件](./docs/关卡和胜负条件需求.md) ✅

## 需求概览

### 连连看系统
- **网格规格**：7×9网格
- **图案类型**：金币、木头、石头、秘银、食物
- **消除规则**：经典连连看，最多3条直线连接
- **资源掉落**：消除后有概率掉落对应资源

### 塔防系统
- **建筑类型**：弓箭塔（当前版本唯一建筑）
- **攻击机制**：自动攻击最近怪物，有飞行时间
- **放置方式**：自动从左到右放置
- **建筑生命值**：可被怪物攻击摧毁

### 资源经济系统
- **资源管理**：5种资源无存储上限
- **收集机制**：矮人按掉落时间优先收集
- **消耗用途**：购买建筑物
- **无转换**：资源间不可转换

### 矮人NPC系统
- **单一矮人**：只有一个矮人NPC
- **任务优先级**：建造 > 收集 > 空闲
- **移动限制**：仅水平移动，可穿过建筑
- **工作流程**：自动执行各种任务

### 怪物战斗系统
- **怪物类型**：基础怪物（当前版本）
- **移动方式**：从右到左直线移动
- **攻击方式**：近战攻击建筑物
- **死亡处理**：有概率掉落资源后消失

### 商店建筑系统
- **商店机制**：常驻2个商品栏位
- **刷新条件**：全部购买后重新刷新
- **购买流程**：点击购买，资源足够则扣除并建造
- **配置驱动**：商品池完全可配置

### 关卡胜负系统
- **胜利条件**：击败所有配置的怪物波次
- **失败条件**：任何怪物到达城堡
- **关卡推进**：线性推进，胜利后自动进入下一关
- **重试机制**：失败后可重新开始当前关卡

## 技术要求

### 开发平台
- 待定（根据技术选型确定）

### 性能要求
- 流畅的动画效果
- 响应式交互
- 稳定的游戏循环

## 版本规划

### 第一版本（MVP）
- 基础连连看系统
- 单一建筑物类型（弓箭塔）
- 基础怪物系统
- 简单的经济系统

### 后续版本
- 更多建筑物类型
- 特殊道具和技能
- 关卡系统
- 成就系统

---

*文档创建时间：2025年7月8日*
*最后更新时间：2025年7月8日*